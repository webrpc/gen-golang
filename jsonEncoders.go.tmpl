{{- define "jsonEncoders" -}}
{{- $opts := .Opts -}}

{{- if eq $opts.json "jsoniter" }}

// Opinionated configuration for -json=jsoniter encoding.
// Reference: https://github.com/json-iterator/go/blob/master/config.go
var jsonCfg = jsoniter.Config{
	ValidateJsonRawMessage: true,
}.Froze()

{{- else if eq $opts.json "sonic" }}

// Opinionated configuration for -json=sonic encoding.
// Reference: https://github.com/bytedance/sonic/blob/main/api.go
var jsonCfg = sonic.Config{
    NoNullSliceOrMap: true,        // Encode nil slices/maps as '[]'/'{}' instead of 'null' to prevent runtime issues in JavaScript.
    NoValidateJSONMarshaler: true, // Skip validation of JSON output from types implementing json.Marshaler to enhance performance.
    NoValidateJSONSkip: true,      // Bypass validation when skipping over JSON values during decoding, improving efficiency.
}.Froze()

{{- end -}}
{{- end -}}
